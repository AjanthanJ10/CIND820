import pandas as pd
import seaborn as sns

import matplotlib.pyplot as plt

# Load your dataset
file_path = "/Users/ajanthanjoseph/Documents/GitHub/CIND820/heart_failure_clinical_records_dataset.csv"
df = pd.read_csv(file_path)

# Display the first few rows of the dataframe
print(df.head())

# Display basic information about the dataframe
print(df.info())

# Display summary statistics of the dataframe
print(df.describe())

# Check for missing values
print(df.isnull().sum())

sns.countplot(x='DEATH_EVENT', data=df)
plt.title('Distribution of Death Events')
plt.show()

print(df['DEATH_EVENT'].value_counts(normalize=True) * 100)

# Plot boxplots for each numerical feature
numerical_features = ['age', 'creatinine_phosphokinase', 'ejection_fraction', 'platelets', 'serum_creatinine', 'serum_sodium']
for feature in numerical_features:
    plt.figure(figsize=(8, 4))
    sns.histplot(df[feature], kde=True, bins=30)
    plt.title(f'Distribution of {feature}')
    plt.show()


for feature in numerical_features:
    plt.figure(figsize=(8, 4))
    sns.kdeplot(df[df['DEATH_EVENT'] == 0][feature], label='Survived', shade=True)
    sns.kdeplot(df[df['DEATH_EVENT'] == 1][feature], label='Died', shade=True)
    plt.title(f'{feature} Distribution by Death Event')
    plt.legend()
    plt.show()

for feature in numerical_features:
    plt.figure(figsize=(8, 4))
    sns.boxplot(x='DEATH_EVENT', y=feature, data=df)
    plt.title(f'{feature} by Death Event')
    plt.show()

categorical_features = ['anaemia', 'diabetes', 'high_blood_pressure', 'sex', 'smoking']
for feature in categorical_features:
    plt.figure(figsize=(8, 4))
    sns.countplot(x=feature, hue='DEATH_EVENT', data=df)
    plt.title(f'Death Event by {feature}')
    plt.show()

for feature in categorical_features:
    print(pd.crosstab(df[feature], df['DEATH_EVENT'], normalize='index'))

# Plot histograms for each numerical feature
df.hist(bins=30, figsize=(20, 15))
plt.show()

# Plot correlation matrix
plt.figure(figsize=(10, 6))
sns.heatmap(df.corr(), annot=True, cmap='coolwarm')
plt.show()

sns.pairplot(df[['age', 'ejection_fraction', 'serum_creatinine', 'DEATH_EVENT']], hue='DEATH_EVENT')
plt.show()